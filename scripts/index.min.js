(function(){var a,b={}.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};window.google&&(a=function(a){function b(a){this.el=$("<div class='google-maps-popover' style='display: none'></div>")[0],this._margin={x:a.marginByX||4,y:a.marginByY||4},a.content&&this.content(a.content),this.setMap(a.map||function(){throw new Error('"map" is required')}())}return c(b,a),b.prototype.onAdd=function(){var a,b,c,d,e;for(b=function(a){return a.stopPropagation()},e=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"],c=0,d=e.length;d>c;c++)a=e[c],google.maps.event.addDomListener(this.el,a,b);return google.maps.event.addDomListener(this.el,"contextmenu",function(){return!1}),google.maps.event.addDomListener(this.el,"mouseover",function(){return this.style.cursor="default"}),this.getPanes().floatPane.appendChild(this.el)},b.prototype.draw=function(){var a,b,c;if(this._visible)return $(".gm-style").removeClass("gm-style"),b=this.getProjection().fromLatLngToDivPixel(this._position),a=this.el.ownerDocument.defaultView.getComputedStyle(this.el,null),c=parseInt(a.getPropertyValue("width"),10),isNaN(c)||(b.x-=c/2),this.el.style.position="absolute",this.el.style.left=b.x+"px",this.el.style.top=b.y+"px",this.el.style.display=this._visible?"block":"none"},b.prototype.onRemove=function(){return this.el?(this.el.parentNode.removeChild(this.el),this.el=null):void 0},b.prototype.show=function(a){return a instanceof google.maps.Marker?this._position=a.getPosition():a instanceof google.maps.LatLng&&(this._position=a),this._visible=!0,this.draw(),this.moveIntoViewport()},b.prototype.moveIntoViewport=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o;return a=$(this.el),l=parseInt(a.outerWidth(!0),10),c=parseInt(a.outerHeight(!0),10),d=this.getMap().getDiv(),m=[d.offsetWidth,d.offsetHeight],f=m[0],e=m[1],n=[this._margin.x,this._margin.y],g=n[0],h=n[1],o=[0,0],j=o[0],k=o[1],b=l/2,i=this.getProjection().fromLatLngToContainerPixel(this._position),i.x<g+b?j=i.x-g-b:i.x+b+g>f&&(j=i.x+b+g-f),i.y+c+h>e&&(k=i.y+c+h-e),0!==j||0!==k?this.getMap().panBy(j,k):void 0},b.prototype.content=function(a){return $(this.el).html(a),this},b.prototype.hide=function(){return this._visible=!1,this.el.style.display="none"},b.prototype.destroy=function(){return google.maps.event.clearInstanceListeners(this.el),this.setMap(null)},b}(google.maps.OverlayView),window.GoogleMapsPopover=a)}).call(this),function(){$.getWithYQL=function(a,b){var c,d;return d=encodeURIComponent('select * from html where url="'+a+'"'),c=$.Deferred(),$.getJSON(""+$.getWithYQL.defaults.serviceURL+"?q="+d+"&format=xml&diagnostics=true&callback=?",function(a){var d,e,f,g,h;return d=null!=(e=a.query)?null!=(f=e.diagnostics)?f.url:void 0:void 0,(null!=d?d.error:void 0)?c.rejectWith(null,[null,d["http-status-code"],d["http-status-message"]]):!(null!=(g=a.results)?g.length:void 0)>0?c.rejectWith(null):b(null!=(h=a.results)?h[0]:void 0)}).then(function(){return c.resolveWith(null,arguments)},function(){return c.rejectWith(null,arguments)}),c.promise()},$.getWithYQL.defaults={serviceURL:"http://query.yahooapis.com/v1/public/yql"}}.call(this),function(){var a;a=function(){function a(a){this.countryCode=a.countryCode||function(){throw new Error('"countryCode" is required')}()}return a.defaults={serviceURL:"http://www.xroxy.com/proxylist.php"},a.prototype.name="xroxy.com",a.prototype.fetch=function(b){var c,d,e,f;return e=(null!=b?b.pageNumber:void 0)||0,f=""+a.defaults.serviceURL+"?sort=latency&type=transparent"+("&country="+this.countryCode+"&pnum="+e),c=new $.Deferred,d=$.getWithYQL(f,function(a){var b,d;return d=[],b=$((new DOMParser).parseFromString(null!=a?a:"","text/xml")),$(".row0, .row1",b).each(function(){var a;return a=$(this).find("td a"),d.push({host:$.trim($(a[1]).text()),port:parseInt($(a[2]).text(),10),type:$(a[3]).text()})}),c.resolve(d)}),d.fail(function(){return c.rejectWith(null,arguments)}),c.promise()},a}(),window.XroxyProxyListProvider=a}.call(this),function(){Selectize.define("copy_to_clipboard",function(){var a;if(ZeroClipboard.detectFlashSupport())return a=new ZeroClipboard,a.on("load",function(){var b;return b=$(a.htmlBridge),b.tipsy({gravity:"sw"}),a.on("complete",function(){return b.attr("title","Copied").tipsy("show")})}),this.setup=function(b){return function(){return this.settings.render.item=function(a){return"            <div class='item' style='display: inline'>                "+a.text+"                <a class='copy-to-clipboard-button' tabindex='-1' href='javascript:void(0)'                   title='Copy To Clipboard' data-clipboard-text='"+a.text+"'>                    <i class='icon-clipboard'></i>                </a>            </div>            "},this.refreshOptions=function(b){return function(){var c;return b.apply(this,arguments),"undefined"!=typeof c&&null!==c&&a.unglue(c),c=this.$control.find(".copy-to-clipboard-button"),a.glue(c)}}(this.refreshOptions),b.apply(this,arguments)}}(this.setup)})}.call(this),function(){Selectize.define("load_more",function(a){var b;return a=$.extend({loadTemplate:"load more",loadingTemplate:"loading",className:"load-more"},a),b=!0,this.refreshOptions=function(c){return function(){return c.apply(this,arguments),this.isOpen&&b?this.$dropdown_content.append("<div class='option "+a.className+"' data-selectable>"+a.loadTemplate+"</div>"):void 0}}(this.refreshOptions),this.load=function(c){return function(d){return c.call(this,function(c){return d.call(this,function(d){return(null!=d?d.length:void 0)!==a.fetchSize&&(b=!1),c.call(this,d)})})}}(this.load),this.onOptionSelect=function(b){return function(c){var d;if(d=$(c.currentTarget),d.hasClass(a.className)){if(c.preventDefault&&c.preventDefault(),this.loading)return;return d.html(a.loadingTemplate),this.load(function(a){return this.settings.load.apply(this,[this.$control_input.val()||"",a])})}return b.apply(this,arguments)}}(this.onOptionSelect)})}.call(this),function(){Selectize.define("select_on_preload",function(){var a;if(this.settings.preload)return a=this.onSearchChange,this.onSearchChange=function(a){var b;return b=this.settings.load,b&&!this.loadedSearches.hasOwnProperty(a)?(this.loadedSearches[a]=!0,this.load(function(c){return b.apply(this,[a,c])})):void 0},this.setup=function(b){return function(){var c;return this.on("load",c=function(b){return(null!=b?b.length:void 0)&&this.setValue(b[0][this.settings.valueField]),this.onSearchChange=a,this.off("load",c)}),b.apply(this,arguments)}}(this.setup)})}.call(this),function(){Selectize.define("persistent_value",function(){var a,b;if(window.localStorage)return b=window.localStorage,a="selectize-#"+this.$input.attr("id")||function(){throw new Error('"id" is required')}(),this.setup=function(c){return function(){var d,e,f,g,h,i,j,k,l;if(this.on("change",function(b){return localStorage.setItem(a,b)}),c.apply(this,arguments),h=b.getItem(a)){for(l=this.settings,g=l.valueField,d=l.labelField,i=h.split(this.settings.delimiter),j=0,k=i.length;k>j;j++)f=i[j],e={},e[g]=e[d]=f,this.addOption(e);return this.setValue(i)}}}(this.setup)})}.call(this),function(){var a;a=function(){function a(){}return a.defaults={serviceURL:"http://freegeoip.net/json/"},a.prototype.name="freegeoip.net",a.prototype.fetch=function(){var b,c;return b=new $.Deferred,c=$.getJSON(""+a.defaults.serviceURL+"?callback=?",function(a){return b.resolve({latitude:a.latitude,longitude:a.longitude})}),c.fail(function(){return b.rejectWith(null,arguments)}),b.promise()},a}(),window.FreegeoipGeolocationProvider=a}.call(this),function(){var a;a=function(){function a(a){this.$el=$("<div class='unotify' style='display: none'></div>"),this.$el.appendTo("body"),this._autoHideTimeout=7e3,null!=(null!=a?a.content:void 0)&&this.content(a.content)}return a.prototype.show=function(){return this.$el.fadeIn(),this._autoHideIn(this._autoHideTimeout),this},a.prototype.isShown=function(){return this.$el.is(":visible")},a.prototype._autoHideIn=function(a){var b=this;return null!=this._timeoutHandle&&clearTimeout(this._timeoutHandle),this._timeoutHandle=setTimeout(function(){return b._timeoutHandle=null,b.hide()},a)},a.prototype.content=function(a){return this.$el.html(a),this.isShown()&&this._autoHideIn(this._autoHideTimeout),this},a.prototype.hide=function(){return this.$el.fadeOut(),this},a}(),window.UNotify=a}.call(this),function(){var a,b,c,d;c=function(a){var b,c,d;return google.maps.visualRefresh=!0,b=function(a){return{featureType:a,stylers:[{visibility:"off"}]}},c=new google.maps.Map(a,{zoom:3,center:new google.maps.LatLng(32,0),mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1,panControl:!1,streetViewControl:!1,scrollwheel:!1,zoomControlOptions:{position:google.maps.ControlPosition.LEFT_CENTER},styles:[b("administrative.province"),b("administrative.locality"),b("administrative.neighborhood"),b("road"),b("poi"),b("transit")]}),google.maps.event.addListener(c,"zoom_changed",function(a,b){return function(){var d;return d=c.getZoom(),a>d?c.setZoom(a):d>b?c.setZoom(b):void 0}}(3,6)),d=c.getCenter(),google.maps.event.addListener(c,"center_changed",function(){var a,b;return(b=c.getBounds())?85.0511>b.getNorthEast().lat()&&b.getSouthWest().lat()>-85.0511?d=c.getCenter():(a=c.getCenter(),c.panTo(new google.maps.LatLng(d.lat(),a.lng()))):void 0}),c},b=function(a,b){var c;return c=null,google.maps.event.addListener(a,"click",function(a){return c=setTimeout(function(){return b(a)},250)}),google.maps.event.addListener(a,"dblclick",function(){return clearTimeout(c)})},d=function(a,b){return function(c,d){var e,f;return e=this.$control,f=e.data("offset")||0,$.when(f?a.fetch({pageNumber:f}):b).done(function(a){var b,c;return e.data("offset",f+1),d(function(){var d,e,f;for(f=[],d=0,e=a.length;e>d;d++)b=a[d],c=""+b.host+":"+b.port,f.push({value:c,text:c});return f}())})}},a=function(){function a(a){this.$el=$(a.el),this.initializePlugins(a.plugins)}return a.prototype.veil=function(a){return this.$veil||(this.$veil=$('<div class="veil" style="display: none"><div class="center"></div></div>').appendTo($(document.body)),new Spinner({lines:13,length:0,radius:60,trail:60}).spin(this.$veil.find(".center")[0])),this.$veil[a?"show":"hide"]()},a.prototype.determineCountryByLatLng=function(a){var b;return this.geocoder||(this.geocoder=new google.maps.Geocoder),b=new $.Deferred,this.geocoder.geocode({latLng:a},function(a,c){var d,e,f;if(c===google.maps.GeocoderStatus.OK)for(e=0,f=a.length;f>e;e++)if(d=a[e],-1!==d.types.indexOf("country"))return b.resolve(d);return b.reject()}),b.promise()},a.prototype.notify=function(a){return this.uNotify||(this.uNotify=new UNotify),this.uNotify.content(a),this.uNotify.isShown()?void 0:this.uNotify.show()},a.prototype.reportAnError=function(a){return this.notify(""+a+".<br/>Click <a href='https://github.com/openproxy/openproxy.github.io/wiki'>here<a/> for more information.")},a.prototype.render=function(){var a,e,f,g,h,i=this;return window.google?(this.$el.html(JST.openproxy()).find("a[title]").tipsy(),e=c(this.$el.find("#map-container")[0]),h=new GoogleMapsPopover({map:e}),f=function(a){return e.panTo(a.latLng),h.hide(),i.veil(!0),i.determineCountryByLatLng(a.latLng).done(function(a){var b,c;return b=a.address_components[0].short_name,c=new XroxyProxyListProvider({countryCode:b}),c.fetch().done(function(b){var e;return h.content(i.popoverTemplate(b)),"function"==typeof i.customizePopover&&i.customizePopover(h),e=$(h.el).find(".selectize"),e.selectize({plugins:["select_on_preload",{name:"load_more",options:{fetchSize:10}},"copy_to_clipboard"],preload:!0,load:d(c,b)}),i.veil(!1),h.show(a.geometry.location)}).fail(function(){return i.veil(!1),i.reportAnError("Unable to retrieve list of proxies (from "+c.name+")")})}).fail(function(){return i.veil(!1)})},b(e,f),g=new google.maps.Marker({map:e}),google.maps.event.addListener(g,"click",f),a=new FreegeoipGeolocationProvider,a.fetch().done(function(a){var b;return b=new google.maps.LatLng(a.latitude,a.longitude),i.determineCountryByLatLng(b).done(function(a){return g.setPosition(a.geometry.location),e.panTo(g.getPosition())})}).fail(function(){return i.reportAnError("Unable to resolve current geolocation (using "+a.name+")")}),this):void(this.$el[0].hasChildNodes()||this.$el.html(JST["openproxy.recovery"]()))},a.prototype.popoverTemplate=function(a){var b;return b=["<span class='google-maps-popover-arrow-up'></span>"],b.push(a.length?"<select id='proxy-list' class='selectize'/>":"<div id='empty-proxy-list'>No proxies in this location</div>"),b.join("")},a}(),MicroPlugin.mixin(a),window.OpenProxy=a}.call(this),function(){var a;a=new $.Deferred,window.addEventListener("message",function(b){return"OP_CHROME_EXTENSION_INITIALIZED"===b.data.type?a.resolve():void 0}),OpenProxy.define("chrome",function(){var b=this;return a.done(function(){return window.google?(b.render=function(a){return function(){var b,c;return c=a.apply(this,arguments),b=$("#toolbar"),$('<span style="display: none">\n    <span class="bb-divider"></span>\n    <a id="reset-btn" class="icon" title="Clear Proxy Settings" href="javascript:void(0)" data-tipsy-gravity="nw">\n        <i class="icon-unlink"></i>\n    </a>\n</span>').appendTo(b).fadeIn().find("#reset-btn").tipsy().on("click",function(a){var b;return b=$(a.currentTarget),b.attr("title","Cleared").tipsy("show").attr("title","Clear Proxy Settings"),window.postMessage({type:"OP_PROXY_OFF"},"*")}),c}}(b.render),b.popoverTemplate=function(a){return function(b){var c;return c=a.apply(this,arguments),b.length&&(c+='<div id="advanced-options" style=\'display: none\'>\n    <div><input id="included-hosts" type="text" placeholder=\'Hosts to include (e.g. *.site.com, site.com)\'/></div>\n    <div><input id="excluded-hosts" type="text" placeholder=\'Hosts to exclude\'/></div>\n</div>\n<div id=\'advanced-options-toggle-container\'>\n    <a id="advanced-options-toggle" href="javascript:void(0)">(show advanced options)</a>\n</div>\n<button id=\'btn-activate\' class=\'btn btn-yellow\'>Activate</button>'),c}}(b.popoverTemplate),b.customizePopover=function(a){var b,c,d,e;return b=$(a.el),c=function(){var a;return a=b.find("#btn-activate"),a.prop("disabled")?a.text("Activate").prop("disabled",!1):void 0},b.on("change","select",c),d=!1,b.on("click","#btn-activate",function(a){var c,e,f,g,h;return g=b.find("select").val().split(":"),2===g.length?(c=$(a.target),c.prop("disabled",!0),f={host:g[0],port:parseInt(g[1],10)},b.find("#advanced-options").is(":visible")&&(h=b.find("#included-hosts").val(),h&&(f.whitelist=h.split(",")),h=b.find("#excluded-hosts").val(),h&&(f.blacklist=h.split(",")),window.postMessage({type:"OP_PROXY_ON",body:f},"*")),c.text("Activated"),d?void 0:(d=!0,e=$("#reset-btn"),e.attr("title","Just so you know, button to reset proxy settings is here.").tipsy("show").attr("title","Clear Proxy Settings"),setTimeout(function(){return e.tipsy("hide")},7e3))):void 0}),b.on("click","#advanced-options-toggle",function(a){var d,e;return e=$(a.currentTarget),d=b.find("#advanced-options"),e.text("("+(d.is(":visible")?"show":"hide")+" advanced options)"),c(),d.toggle()}),e={plugins:["persistent_value"],persist:!1,create:function(a){return{value:a,text:a}}},this.customizePopover=function(){var a,d,f,g,h,i,j,k,l,m;for(k=function(){var a,c,d,f;for(d=["#included-hosts","#excluded-hosts"],f=[],a=0,c=d.length;c>a;a++)h=d[a],f.push(b.find(h).selectize(e)[0].selectize);return f}(),d=k[0],a=k[1],g=function(a){return function(){return a[this.getValue()?"disable":"enable"](),c()}},d.on("change",g(a)),a.on("change",g(d)),l=[d,a],m=[],i=0,j=l.length;j>i;i++)f=l[i],m.push(f.trigger("change",f.$input.val()));return m},this.customizePopover()}):(b.$el.html(JST["openproxy.chrome.plugin.recovery"]()),void b.$el.find("#reset-btn").tipsy().on("click",function(a){var b;return b=$(a.currentTarget),b.attr("title","Cleared. You may want to refresh page now.").tipsy("show").attr("title","Clear Proxy Settings"),window.postMessage({type:"OP_PROXY_OFF"},"*")}))})})}.call(this),this.JST=this.JST||{},this.JST["openproxy.chrome.plugin.recovery"]=function(){var a=[];return a.push('<div class="vhc-container"><div class="vhc"><div id="recovery-container"><div class="logo">OpenProxy</div><div class="hint">(recovery mode)</div><a id="reset-btn" href="javascript:void(0)" title="Clear Proxy Settings" class="icon"><i class="icon-unlink"></i></a></div></div></div>'),a.join("")},this.JST.openproxy=function(){var a=[];return a.push('<div class="bb-container"><div class="bb bb-compact"><div class="logo">OpenProxy</div></div><div class="bb">World of open proxies on Google Maps<div class="hint">(click on any country to get a list)</div></div><div id="toolbar" class="bb"><a href="https://github.com/openproxy/openproxy-chrome-extension" title="OpenProxy Chrome Extension" data-tipsy-gravity="nw" class="icon"><i class="icon-chrome"></i></a></div></div><div class="github-fork-ribbon-wrapper right"><div class="github-fork-ribbon"><a href="https://github.com/openproxy/openproxy.github.io">Fork me on GitHub</a></div></div><div id="map-container"></div>'),a.join("")},this.JST["openproxy.recovery"]=function(){var a=[];return a.push('<div class="vhc-container"><div class="vhc"><div id="recovery-container"><div class="logo">OpenProxy</div><div class="hint">(offline mode)</div><div style="margin-top: 12px; margin-bottom: 12px">OpenProxy was unable to load Google Maps. Please check your Internet connection.</div><div class="hint">If you think this is a mistake,<br/> please let us know through&nbsp;<a href="https://github.com/openproxy/openproxy.github.io/issues">Github issue tracker</a>.</div></div></div></div>'),a.join("")},function(){var a;window.applicationCache&&(a=new $.Deferred,window.applicationCache.addEventListener("updateready",a.resolve)),$(window).load(function(){var b;return b=new OpenProxy({el:document.getElementById("application-container"),plugins:["chrome"]}).render(),null!=a?a.then(function(){return b.notify('A new version of OpenProxy is available.<br/> Please\n<a href="javascript:window.location.reload()">refresh<a/> the page to complete an update.')}):void 0})}.call(this);